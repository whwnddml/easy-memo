"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[436],{3227:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(7437),a=n(2265),i=n(3443);let s=()=>{let e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),t="ontouchstart"in window||navigator.maxTouchPoints>0,n=window.innerWidth<=768;return!e&&!t&&!n};function o(){let[e,t]=(0,a.useState)(""),{addMemo:n,isLoading:o}=(0,i.j)(),l=async r=>{r.preventDefault(),e.trim()&&(await n({content:e.trim()}),t(""))};return(0,r.jsxs)("form",{onSubmit:l,className:"memo-form",children:[(0,r.jsx)("textarea",{value:e,onChange:e=>t(e.target.value),onKeyDown:e=>{(e.ctrlKey||e.metaKey)&&"Enter"===e.key&&(e.preventDefault(),l(e))},placeholder:s()?"메모를 입력하세요... (Ctrl+Enter로 저장)":"메모를 입력하세요...",disabled:o,className:"w-full p-3 border border-gray-300 rounded-md resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:4}),(0,r.jsx)("button",{type:"submit",disabled:!e.trim()||o,className:"mt-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:o?"저장 중...":"저장"})]})}},933:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(7437),a=n(2265),i=n(3443),s=n(9089);let o=()=>/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,l=()=>window.matchMedia("(max-width: 768px)").matches;function c(){let{memos:e,deleteMemo:t,updateMemo:n,fetchMemos:c,loadMoreMemos:d,isLoading:u,isLoadingMore:m,hasMore:h}=(0,i.j)(),[f,g]=(0,a.useState)(null),[p,x]=(0,a.useState)(""),[b,w]=(0,a.useState)({appType:"",os:"",osVersion:"",browser:"",browserVersion:"",deviceModel:"",userAgent:""}),j=(0,a.useCallback)(async()=>{await c()},[c]);(0,a.useEffect)(()=>{j()},[j]),(0,a.useEffect)(()=>{let e=()=>{if(!u&&!m&&h)document.documentElement.scrollHeight-(window.scrollY||document.documentElement.scrollTop)<=document.documentElement.clientHeight+100&&d()};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[d,u,m,h]),(0,a.useEffect)(()=>{(()=>{let e=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://"),t=navigator.userAgent,n=t.toLowerCase(),r="unknown",a="unknown",i="unknown";if(n.includes("iphone")||n.includes("ipad")){r="iOS";let e=t.match(/OS\s([0-9_]*)/);if(e&&(a=e[1].replace(/_/g,".")),n.includes("iphone")){i="iPhone";let e=t.match(/iPhone\s*(?:(?:\d+,\d+)|(?:[A-Za-z]+))/i);e&&(i=e[0])}else if(n.includes("ipad")){i="iPad";let e=t.match(/iPad\s*(?:(?:\d+,\d+)|(?:[A-Za-z]+))/i);e&&(i=e[0])}}else if(n.includes("android")){r="Android";let e=t.match(/Android\s([0-9.]+)/);e&&(a=e[1]);let n=t.match(/;\s([^;)]+)\sBuild\//);n&&(i=n[1].trim())}else if(n.includes("windows")){r="Windows";let e=t.match(/Windows\sNT\s([0-9.]+)/);if(e){let t=e[1];a=({"10.0":"11/10","6.3":"8.1","6.2":"8","6.1":"7","6.0":"Vista","5.2":"Server 2003/XP x64","5.1":"XP","5.0":"2000"})[t]||t}i=n.includes("wow64")||n.includes("win64")?"x64":"x86"}else if(n.includes("macintosh")||n.includes("mac os")){r="macOS";let e=t.match(/Mac OS X\s*([0-9_\.]+)/);if(e){let t=parseInt((a=e[1].replace(/_/g,".")).split(".")[0]);if(t>=11)a+=" (Big Sur 이상)";else if(10===t){let e=parseInt(a.split(".")[1]),t={15:"Catalina",14:"Mojave",13:"High Sierra",12:"Sierra",11:"El Capitan",10:"Yosemite",9:"Mavericks",8:"Mountain Lion",7:"Lion",6:"Snow Leopard"};t[e]&&(a+=" (".concat(t[e],")"))}}n.includes("arm64")?i="Apple Silicon":n.includes("intel")&&(i="Intel")}else n.includes("linux")&&(r="Linux",n.includes("ubuntu")?a="Ubuntu":n.includes("fedora")?a="Fedora":n.includes("debian")&&(a="Debian"),i=n.includes("x86_64")||n.includes("x64")?"x64":n.includes("arm")?"ARM":"x86");let s="unknown",o="unknown";if(n.includes("crios")){s="Chrome iOS";let e=t.match(/CriOS\/([0-9.]+)/);e&&(o=e[1])}else if(n.includes("chrome")){s="Chrome";let e=t.match(/Chrome\/([0-9.]+)/);e&&(o=e[1])}else if(n.includes("safari")){s="Safari";let e=t.match(/Version\/([0-9.]+)/);e&&(o=e[1])}else if(n.includes("firefox")){s="Firefox";let e=t.match(/Firefox\/([0-9.]+)/);e&&(o=e[1])}else if(n.includes("edg/")){s="Edge";let e=t.match(/Edg\/([0-9.]+)/);e&&(o=e[1])}else if(n.includes("opr/")){s="Opera";let e=t.match(/OPR\/([0-9.]+)/);e&&(o=e[1])}w({appType:e?"PWA":"Web",os:r,osVersion:a,browser:s,browserVersion:o,deviceModel:i,userAgent:t})})()},[]);let v=(0,a.useCallback)(e=>{g(e.id),x(e.content)},[]),y=(0,a.useCallback)(async t=>{if(p.trim())try{let r=e.find(e=>e.id===t);r&&await n({...r,content:p.trim(),updatedAt:new Date().toISOString()}),g(null),x("")}catch(e){console.error("메모 수정 중 오류:",e),alert("메모 수정에 실패했습니다.")}},[p,n]),k=(0,a.useCallback)(()=>{g(null),x("")},[]),S=o(),[A,N]=(0,a.useState)(1),M=(0,a.useRef)(null);(0,a.useRef)(!1);let L=(0,a.useRef)(null);(0,a.useEffect)(()=>{if(S||!h)return;let e=new IntersectionObserver(async e=>{let[t]=e;t.isIntersecting&&!u&&h&&(console.log("Observer 감지, 추가 로드 시도"),await d())},{root:null,rootMargin:"100px",threshold:.1}),t=L.current;return t&&e.observe(t),()=>{t&&e.unobserve(t)}},[S,h,u,d]);let E=(0,a.useCallback)(async()=>{N(1),await c(!0)},[c]),C=(0,a.useCallback)(async()=>{A>1&&(N(e=>e-1),await c(!0))},[A,c]),P=(0,a.useCallback)(async()=>{h&&(N(e=>e+1),await d())},[h,d]);return(0,r.jsxs)("div",{className:"memo-list-container",ref:M,children:[S&&(0,r.jsx)("div",{className:"ios-controls",children:(0,r.jsx)("button",{className:"refresh-button",onClick:E,children:(0,r.jsx)(s.lbL,{className:u?"spinning":""})})}),(0,r.jsx)("div",{className:"loading-overlay ".concat(u?"visible":""),children:(0,r.jsx)("div",{className:"loading-spinner"})}),(0,r.jsxs)("div",{className:"memo-list",children:[0!==e.length||u?e.map(e=>(0,r.jsx)("div",{className:"memo-item",children:f===e.id?(0,r.jsxs)("div",{className:"memo-edit",children:[(0,r.jsx)("textarea",{value:p,onChange:e=>x(e.target.value),className:"edit-textarea"}),(0,r.jsxs)("div",{className:"edit-buttons",children:[(0,r.jsx)("button",{className:"save-btn",onClick:()=>y(e.id),disabled:!p.trim()||u,children:"저장"}),(0,r.jsx)("button",{className:"cancel-btn",onClick:k,disabled:u,children:"취소"})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"memo-content",children:e.content}),(0,r.jsxs)("div",{className:"memo-date",children:[(0,r.jsx)("span",{children:new Date(e.createdAt).toLocaleString("ko-KR")}),(0,r.jsx)("div",{className:"memo-actions",children:l()?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>v(e),disabled:u,"aria-label":"수정",className:"min-w-[40px] max-w-[40px] w-[40px] h-[40px] flex items-center justify-center rounded-[10px] bg-transparent text-[#b0b8c1] transition-colors duration-200 hover:bg-[#2c313a] hover:text-[#4f8cff] disabled:opacity-50 disabled:cursor-not-allowed",children:(0,r.jsx)(s.fmQ,{size:14,color:"#2563eb"})}),(0,r.jsx)("button",{onClick:()=>{window.confirm("정말로 이 메모를 삭제하시겠습니까?")&&t(e.id)},disabled:u,"aria-label":"삭제",className:"min-w-[40px] max-w-[40px] w-[40px] h-[40px] flex items-center justify-center rounded-[10px] bg-transparent text-[#ff3b3b] transition-colors duration-200 hover:bg-[#2c313a] disabled:opacity-50 disabled:cursor-not-allowed",children:(0,r.jsx)(s.Xm5,{size:14,color:"#ff3b3b"})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>v(e),disabled:u,"aria-label":"수정",className:"min-w-[40px] max-w-[40px] w-[40px] h-[40px] flex items-center justify-center rounded-[10px] bg-transparent text-[#b0b8c1] transition-colors duration-200 hover:bg-[#2c313a] hover:text-[#4f8cff] disabled:opacity-50 disabled:cursor-not-allowed",children:(0,r.jsx)(s.fmQ,{size:18,color:"#2563eb"})}),(0,r.jsx)("button",{onClick:()=>{window.confirm("정말로 이 메모를 삭제하시겠습니까?")&&t(e.id)},disabled:u,"aria-label":"삭제",className:"min-w-[40px] max-w-[40px] w-[40px] h-[40px] flex items-center justify-center rounded-[10px] bg-transparent text-[#ff3b3b] transition-colors duration-200 hover:bg-[#2c313a] disabled:opacity-50 disabled:cursor-not-allowed",children:(0,r.jsx)(s.Xm5,{size:18,color:"#ff3b3b"})})]})})]})]})},e.id)):(0,r.jsx)("div",{className:"memo-empty",children:(0,r.jsx)("p",{children:"작성된 메모가 없습니다."})}),m&&(0,r.jsxs)("div",{className:"loading-more",children:[(0,r.jsx)("div",{className:"loading-spinner-small"}),(0,r.jsx)("span",{children:"더 많은 메모를 불러오는 중..."})]}),S&&e.length>0&&(0,r.jsxs)("div",{className:"ios-pagination",children:[A>1&&(0,r.jsxs)("button",{className:"page-button prev",onClick:C,disabled:u,children:[(0,r.jsx)(s.s$2,{}),(0,r.jsx)("span",{children:"이전"})]}),h&&(0,r.jsxs)("button",{className:"page-button next",onClick:P,disabled:u,children:[(0,r.jsx)("span",{children:"다음"}),(0,r.jsx)(s.RiI,{})]})]}),!S&&h&&(0,r.jsx)("div",{ref:L,style:{height:"10px",margin:"20px 0"}}),!S&&m&&(0,r.jsxs)("div",{className:"loading-more",children:[(0,r.jsx)("div",{className:"loading-spinner-small"}),(0,r.jsx)("span",{children:"더 많은 메모를 불러오는 중..."})]}),!h&&e.length>0&&(0,r.jsx)("div",{className:"no-more-memos",children:(0,r.jsx)("span",{children:"모든 메모를 불러왔습니다."})})]}),(0,r.jsx)("div",{className:"collection-info",children:(0,r.jsxs)("small",{children:[(0,r.jsxs)("div",{children:["앱 타입: ",b.appType]}),(0,r.jsxs)("div",{children:["운영체제: ",b.os," ",b.osVersion," (",b.deviceModel,")"]}),(0,r.jsxs)("div",{children:["브라우저: ",b.browser," ",b.browserVersion]}),(0,r.jsxs)("div",{children:["User Agent: ",b.userAgent]})]})})]})}},8110:function(e,t,n){n.d(t,{t:function(){return s}});var r=n(9625),a=n(6885);let i="https://junny.dyndns.org:3008/api";if(!i)throw Error("API URL이 설정되지 않았습니다.");let s=(0,r.Ue)()((0,a.tJ)((e,t)=>({isAuthenticated:!1,token:null,userId:null,user:null,isLoading:!1,error:null,login:async(t,n)=>{e({isLoading:!0,error:null});try{let r=await fetch("".concat(i,"/users/login"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:t,password:n})}),a=await r.json();if(!r.ok)throw Error(a.message||"로그인에 실패했습니다.");return e({isAuthenticated:!0,token:a.token,userId:a.userId,user:a.user,isLoading:!1,error:null}),!0}catch(t){return e({isLoading:!1,error:t instanceof Error?t.message:"로그인에 실패했습니다."}),!1}},logout:()=>{e({isAuthenticated:!1,token:null,userId:null,user:null,error:null})},verifyToken:async()=>{let{token:n}=t();if(!n)return!1;try{let t=await fetch("".concat(i,"/users/verify-token"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},credentials:"include"}),r=await t.json();if(!t.ok)throw Error(r.message||"토큰 검증에 실패했습니다.");return e({isAuthenticated:!0,userId:r.userId,user:r.user}),!0}catch(t){return e({isAuthenticated:!1,token:null,userId:null,user:null}),!1}},clearError:()=>{e({error:null})},setLoading:t=>{e({isLoading:t})}}),{name:"auth-storage",partialize:e=>({token:e.token,userId:e.userId,user:e.user,isAuthenticated:e.isAuthenticated})}))},3443:function(e,t,n){n.d(t,{j:function(){return h}});var r=n(9625),a=n(6885),i=n(8110);let s="https://junny.dyndns.org:3008",o=()=>{let e=localStorage.getItem("local-memos");return e?JSON.parse(e):[]},l=e=>{localStorage.setItem("local-memos",JSON.stringify(e))},c=()=>Date.now().toString(36)+Math.random().toString(36).substr(2),d=()=>{let e=i.t.getState();return e.isAuthenticated?e.userId:null},u=()=>{let e=i.t.getState();return e.isAuthenticated?e.token:null},m=()=>{let e=u(),t={Accept:"application/json","Content-Type":"application/json"};return e&&(t.Authorization="Bearer ".concat(e)),t},h=(0,r.Ue)()((0,a.tJ)((e,t)=>({memos:[],isLoading:!1,isLoadingMore:!1,error:null,hasMore:!0,currentPage:1,fetchMemos:async function(){let n=!(arguments.length>0)||void 0===arguments[0]||arguments[0],r=t();n&&e({isLoading:!0,error:null,currentPage:1,hasMore:!0});try{if(!d()){let t=o();e({memos:t,isLoading:!1,hasMore:!1});return}let t=n?1:r.currentPage,a=await fetch("".concat(s,"/api/memos?page=").concat(t,"&limit=10"),{headers:m(),mode:"cors",credentials:"include"});if(!a.ok)throw Error("메모를 불러오는데 실패했습니다.");let i=await a.json(),l=i.memos.map(e=>({id:e._id,content:e.content,createdAt:e.createdAt,updatedAt:e.updatedAt}));e({memos:n?l:[...r.memos,...l],isLoading:!1,hasMore:i.pagination.hasMore,currentPage:i.pagination.currentPage})}catch(t){console.error("메모 목록 조회 중 오류:",t),e({error:t instanceof Error?t.message:"메모를 불러오는데 실패했습니다.",isLoading:!1})}},loadMoreMemos:async()=>{let n=t();if(n.hasMore&&!n.isLoadingMore&&!n.isLoading){e({isLoadingMore:!0,error:null});try{if(!d()){e({isLoadingMore:!1});return}let t=n.currentPage+1,r=await fetch("".concat(s,"/api/memos?page=").concat(t,"&limit=10"),{headers:m(),mode:"cors",credentials:"include"});if(!r.ok)throw Error("추가 메모를 불러오는데 실패했습니다.");let a=await r.json(),i=a.memos.map(e=>({id:e._id,content:e.content,createdAt:e.createdAt,updatedAt:e.updatedAt}));e({memos:[...n.memos,...i],isLoadingMore:!1,hasMore:a.pagination.hasMore,currentPage:a.pagination.currentPage})}catch(t){console.error("추가 메모 조회 중 오류:",t),e({error:t instanceof Error?t.message:"추가 메모를 불러오는데 실패했습니다.",isLoadingMore:!1})}}},addMemo:async n=>{e({isLoading:!0,error:null});try{let r=d(),a={id:c(),content:n.content,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};if(!r){let n=t().memos,r=[a,...n];l(r),e({memos:r,isLoading:!1});return}let i=await fetch("".concat(s,"/api/memos"),{method:"POST",headers:m(),mode:"cors",credentials:"include",body:JSON.stringify({content:n.content})});if(!i.ok)throw Error("메모 저장에 실패했습니다.");let o=await i.json();o._id,o.content,o.createdAt,o.updatedAt,await t().fetchMemos(!0)}catch(t){console.error("메모 추가 중 오류:",t),e({error:t instanceof Error?t.message:"메모 저장에 실패했습니다.",isLoading:!1})}},updateMemo:async n=>{e({isLoading:!0,error:null});try{if(!d()){let r=t().memos.map(e=>e.id===n.id?{...n,updatedAt:new Date().toISOString()}:e);l(r),e({memos:r,isLoading:!1});return}let r=await fetch("".concat(s,"/api/memos/").concat(n.id),{method:"PUT",headers:m(),mode:"cors",credentials:"include",body:JSON.stringify({content:n.content})});if(!r.ok)throw Error("메모 수정에 실패했습니다.");let a=await r.json();a._id,a.content,a.createdAt,a.updatedAt,await t().fetchMemos(!0)}catch(t){console.error("메모 수정 중 오류:",t),e({error:t instanceof Error?t.message:"메모 수정에 실패했습니다.",isLoading:!1})}},deleteMemo:async n=>{e({isLoading:!0,error:null});try{if(!d()){let r=t().memos.filter(e=>e.id!==n);l(r),e({memos:r,isLoading:!1});return}if(!(await fetch("".concat(s,"/api/memos/").concat(n),{method:"DELETE",headers:m(),mode:"cors",credentials:"include"})).ok)throw Error("메모 삭제에 실패했습니다.");await t().fetchMemos(!0)}catch(t){console.error("메모 삭제 중 오류:",t),e({error:t instanceof Error?t.message:"메모 삭제에 실패했습니다.",isLoading:!1})}},clearError:()=>{e({error:null})},clearMemos:()=>{e({memos:[],error:null,currentPage:1,hasMore:!0})}}),{name:"memo-storage",partialize:e=>({memos:d()?[]:e.memos})}))}}]);